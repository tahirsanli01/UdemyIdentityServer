@using ADASOIdentityServer.Database.Models

@model IEnumerable<Users>

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@section styles {
    <link href="~/assets/plugins/select2/select2.min.css" rel="stylesheet" />
    <link href="~/assets/plugins/custom/datatables/datatables.bundle.css" rel="stylesheet" />
    <style>
    </style>
}
 

<div id="ModalCreateGoal" class="app-content">
    @await Component.InvokeAsync("DashBoardNavbar")
    <div class="d-flex flex-wrap flex-stack my-1">
        <h3 class="fw-bold my-2">
            Kullanıcı Listesi
            <span class="fs-6 text-gray-400 fw-semibold ms-1">@Model.Count()</span>
        </h3>
        <div class="d-flex my-2">
@*             <div class="d-flex align-items-center position-relative me-4">
                <i class="ki-outline ki-magnifier fs-3 position-absolute translate-middle-y top-50 ms-4"></i>
                <input type="text" id="kt_filter_search" class="form-control form-control-sm form-control-solid bg-body fw-semibold fs-7 w-150px ps-11" placeholder="Firma Ara" />
            </div> *@
            <a href="/Users/Create" class='btn btn-primary btn-sm fw-bolder'>Kullanıcı Oluştur</a>
        </div>
    </div>
    <div class="card">
        <table id="table" class="table table-striped">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Ad Soyad</th>
                    <th>Email</th>
                    <th>Departman</th>
                    <th>Rol</th>
                    <th style="width: 10%;">İşlemler</th>
                    
                </tr>
            </thead>
        </table>
        
    </div>
</div>


@await Component.InvokeAsync("DrawerMainProcess")
@await Component.InvokeAsync("DrawerSubProcess")
@await Component.InvokeAsync("DrawerAttachmentProcess")
@await Component.InvokeAsync("DrawerKPIProcess")
@await Component.InvokeAsync("DrawerSurveyProcess")

@section scripts {
    <script src="~/assets/js/custom/utilities/modals/create-account.js"></script>
    <script src="~/assets/plugins/select2/select2.min.js"></script>
    <script>
        $("#table").DataTable({
            processing: true,
            serverSide: true,
            ajax: {
                url: '/Users/GetUserList',
                type: 'POST',
                contentType: "application/json",
                data: function (d) {
                    return JSON.stringify(d); // JSON formatında gönder
                }
            },
            columns: [
                { data: 'id', title: 'ID' },
                { data: 'name', title: 'Ad Soyad' },
                { data: 'email', title: 'Email' },
                { data: 'department.department1', title: 'Departman' }, // navigation property
                { data: 'role.name', title: 'Rol' },
                {
                    data: 'id',
                    title: 'İşlemler',
                    orderable: false,
                    searchable: false,
                    render: function (data, type, row) {
                        return `
                            <a href="/Users/Edit/${data}"><i class="fa fa-edit fs-2"></i></a> |
                            <a href="/Users/Details/${data}"><i class="fa fa-arrow-right fs-2"></i></a> |
                            <a href="/Users/Delete/${data}"><i class="fa fa-trash fs-2"></i></a>
                        `;
                    }
                }
            ],
            language: {
                lengthMenu: "Show _MENU_"
            },
            dom:
                "<'row'" +
                "<'col-sm-6 d-flex align-items-center justify-conten-start'l>" +
                "<'col-sm-6 d-flex align-items-center justify-content-end'f>" +
                ">" +
                "<'table-responsive'tr>" +
                "<'row'" +
                "<'col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start'i>" +
                "<'col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end'p>" +
                ">"
        });
    </script>

    @*<script src="~/custom/advisor.js"></script>*@
}